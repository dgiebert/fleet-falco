
defaultNamespace: falco

labels:
  app: falco

# Custom helm options
helm:
  releaseName: falco
  chart: falco
  repo: https://falcosecurity.github.io/charts
  version: 4.1.1
  values:
    customRules:
      rules-api-access.yaml: |-
        - macro: user_known_contact_k8s_api_server_activities
          condition: >
            ((k8s.ns.name = "cattle-system" and proc.exepath = "/usr/bin/agent")
            or (k8s.ns.name = "cattle-monitoring-system" and (container.name = "grafana-sc-dashboard" or 
                                                              container.name = "grafana-sc-datasources"))
            or (k8s.ns.name = "cattle-system" 
                and container.name = "proxy"
                and proc.name = "kubectl"))
      rules-kubevip.yaml: |-
        - list: user_known_packet_socket_binaries
          append: yes
          items: ["kube-vip"]
    driver:
      kind: ebpf
    falco:
      grpc:
        enabled: true
      grpc_output:
        enabled: true